# Digital Original NFT Workflow

This document outlines the workflow for managing artists, creating metadata, and minting NFTs on the Digital Original platform.

## 1. Overview

The workflow consists of three main stages:
1.  **Content Management**: Defining artist profiles and NFT details in TinaCMS.
2.  **Asset Storage**: Uploading images and metadata to IPFS using Thirdweb.
3.  **Blockchain Interaction**: Minting NFTs on the Amoy testnet (Polygon) using the deployed smart contracts.

## 2. Content Management (TinaCMS)

We have updated the TinaCMS schema to include an **Artist** collection.

### Managing Artists
1.  Navigate to the TinaCMS admin panel (e.g., `/admin`).
2.  Select **Artists** from the sidebar.
3.  Create a new Artist entry.
4.  Fill in the **Name**, **Bio** (Rich Text), and upload a **Profile Image**.
5.  Save the entry.

This data is stored in the repository (e.g., `content/artists/my-artist.md`) and can be accessed programmatically.

## 3. Image Optimization
We have provided a script `scripts/optimize-images.js` to ensure all images are under 5MB before uploading to IPFS.

### Usage
1.  Place your images in a local directory (e.g., `assets/images`).
2.  Run the script:
    ```bash
    node scripts/optimize-images.js ./assets/images ./assets/optimized-images
    ```
3.  The script will:
    - Check if files are > 5MB.
    - Compress/Resize them if necessary.
    - Save the optimized versions to the output directory.

## 4. Minting Script

We have provided a script `scripts/mint-nft.js` to automate the minting process.

### Prerequisites
- `THIRDWEB_SECRET_KEY` in `.env.local`
- `PRIVATE_KEY` in `.env.local` (funded with Amoy MATIC)
- `NEXT_PUBLIC_THIRDWEB_CLIENT_ID` in `.env.local`

### Usage
Run the script using Hardhat:

```bash
npx hardhat run scripts/mint-nft.js --network amoy
```

### What the Script Does
1.  **Reads Data**: Currently uses mock data (can be connected to TinaCMS content).
2.  **Uploads to IPFS**: Uses the Thirdweb SDK to upload the NFT metadata (including name, description, image, attributes, and artist bio).
3.  **Converts Price**: Converts the USD price to MATIC (using a fixed rate for now).
4.  **Deploys/Connects**: Checks if the artist has a dedicated NFT contract. If not, it deploys one via the `OptimizedArtistFactory`.
5.  **Mints**: Mints the NFT to the artist's wallet with the generated IPFS URI and royalty settings.

## 5. Automation & Autonomous Agents

To fully automate this workflow with an autonomous agent, consider the following architecture:

### Trigger
- **Webhook**: Configure TinaCMS (or GitHub Actions) to trigger a webhook when a new Artist or NFT content file is created/updated.
- **Polling**: An agent can periodically check the `content/` directory for new files.

### Agent Actions
1.  **Parse Content**: The agent reads the Markdown/JSON files generated by TinaCMS.
2.  **Validation**: Checks if all required fields (Image, Price, Bio) are present.
3.  **Execution**:
    - Runs the `mint-nft.js` logic (adapted to accept arguments).
    - Example: `node scripts/mint-nft.js --artist "content/artists/john-doe.md" --nft "content/nfts/art-piece.md"`
4.  **Feedback**:
    - Updates the content file with the **Transaction Hash** and **Contract Address** (so it doesn't get minted again).
    - Sends a notification (Email, Discord) to the admin.

### Future Improvements
- **Dynamic Pricing**: Integrate a Chainlink Price Feed to get real-time MATIC/USD rates.
- **Batch Minting**: Update the script to handle multiple NFTs in one transaction using `batchMint`.
- **Frontend Integration**: Fetch the minted NFTs from the blockchain to display on the website, using the "Sold" status to manage availability.
